#!/bin/sh

if [ -d out ]; then
  cp src/bin/nono out/bin/nono
  cd out/bin
  rm -rf ../src/pkg
  cp -r ../../src/pkg ../src/pkg
  ./nono -i base
  cd ../../
  exit 0
fi

mkdir out
cd out

mkdir -p bin boot dev etc home lib mnt proc opt root share srv src sys tmp var
mkdir -p src/build src/dl src/pkg

touch src/pkgs

ln -sfn . usr
ln -sfn bin sbin

chmod 1777 tmp
chmod 700 root

cp -r ../src/bin/* bin
cp -r ../src/boot/* boot
cp -r ../src/etc/* etc

cp -r ../src/pkg/* src/pkg

cd bin
./nono -i base
